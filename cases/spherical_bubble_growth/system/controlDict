/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  1.7.0                                 |
|   \\  /    A nd           | Web:      www.OpenFOAM.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "system";
    object      controlDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //


application     interConjugateKineticFoam;

startFrom       latestTime;

startTime       0.0;

stopAt          endTime;

// endTime         0.6E-3;
endTime         2e-3;

deltaT          1.0E-9;

writeControl    runTime;
writeInterval   0.6E-5;
// writeInterval 5e-6;

purgeWrite      0;

writeFormat     binary;

writePrecision  10;

writeCompression off;

timeFormat      general;

timePrecision   6;

runTimeModifiable yes;

adjustTimeStep  yes;

maxAlphaCo      0.1;
maxCo           0.1;
maxFourier      1.0E7;
maxDeltaT       2.0;

functions
{
  bubbleVolume
    {
      libs (utilityFunctionObjects);
      type coded;
      name bubbleVolume;

      active yes;
      writeControl timeStep;
      writeInterval 1;
      region fluid;
      codeWrite
        #{
        const volScalarField& alpha = mesh().lookupObject<volScalarField>("alpha.air");
      scalar bubbleV(0);
      bubbleV = fvc::domainIntegrate(alpha).value();

      if( Pstream::master() == true )
        {
          std::ofstream fs;
          fs.open ("bubble.csv", std::ofstream::out | std::ofstream::app);
          fs.precision(8);
          fs << mesh().time().value() << "\t" << bubbleV << "\n" ;
          fs.close();
        }
      #};

      codeInclude
        #{
           #include <fstream>
        #};
    }
}

// ************************************************************************** //
